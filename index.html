<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CPP 손익분기점 시뮬레이터</title>
    <link rel="stylesheet" href="style.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>

    <div class="container">
        <header>
            <h1>CPP 손익분기점 시뮬레이터</h1>
            <p>두 개의 CPP 시작 시점을 비교하여, 세후 기준 손익분기점을 찾아보세요.</p>
            <div class="theme-switch-wrapper">
                <label class="theme-switch" for="theme-toggle">
                    <input type="checkbox" id="theme-toggle" />
                    <div class="slider round"></div>
                </label>
                <span>Dark Mode</span>
            </div>
        </header>

        <main>
            <div class="input-section">
                <h2>1. 정보 입력</h2>
                <div class="form-grid">
                    <fieldset>
                        <legend>기본 정보</legend>
                        <div class="form-group">
                            <label for="province">거주 주 (Province)</label>
                            <select id="province"></select>
                        </div>
                    </fieldset>
                    <fieldset>
                        <legend>나의 정보</legend>
                        <div class="form-group">
                            <label for="userBirthYear">생년 (Birth Year)</label>
                            <input type="number" id="userBirthYear" value="1981">
                        </div>
                        <div class="form-group">
                            <label for="userCppAt65">65세 기준 예상 CPP (연간) <span class="tooltip" data-tooltip="Google에서 'My Service Canada Account'를 검색하여 공식 정부 웹사이트에 로그인 후, CPP 예상 수령액을 확인하십시오. 보안을 위해 직접 링크는 제공하지 않습니다.">?</span></label>
                            <input type="number" id="userCppAt65" value="10000">
                        </div>
                    </fieldset>
                    <fieldset>
                        <legend>배우자 정보</legend>
                        <div class="form-group">
                            <input type="checkbox" id="hasSpouse" checked>
                            <label for="hasSpouse">배우자 정보 포함</label>
                        </div>
                        <div id="spouse-info-group">
                            <div class="form-group">
                                <label for="spouseBirthYear">배우자 생년 (Birth Year)</label>
                                <input type="number" id="spouseBirthYear" value="1982">
                            </div>
                            <div class="form-group">
                                <label for="spouseCppAt65">배우자 65세 기준 예상 CPP (연간) <span class="tooltip" data-tooltip="Google에서 'My Service Canada Account'를 검색하여 공식 정부 웹사이트에 로그인 후, CPP 예상 수령액을 확인하십시오. 보안을 위해 직접 링크는 제공하지 않습니다.">?</span></label>
                                <input type="number" id="spouseCppAt65" value="4000">
                            </div>
                        </div>
                    </fieldset>
                    <fieldset>
                        <legend>기타 소득 (CPP 외)</legend>
                        <p>은퇴 후 발생할 다른 소득을 관리합니다.</p>
                        <button id="manage-income-btn" type="button">[기타 소득 관리]</button>
                    </fieldset>
                    <fieldset>
                        <legend>핵심 가정</legend>
                         <div class="form-group">
                            <label for="investmentReturn">초기 투자 수익률 (%) <span class="tooltip" data-tooltip="더 일찍 CPP를 받기 시작했을 때, 그 돈을 더 늦게 받기 시작하는 시점까지 투자했을 경우의 연평균 수익률입니다.">?</span></label>
                            <input type="number" id="investmentReturn" step="0.1" value="11">
                        </div>
                        <div class="form-group">
                            <label for="cola">소득 물가상승률 (COLA, %)</label>
                            <input type="number" id="cola" step="0.1" value="3">
                        </div>
                        <div class="form-group">
                            <label for="lifeExpectancy">최대 계산 나이</label>
                            <input type="number" id="lifeExpectancy" value="100">
                        </div>
                    </fieldset>
                     <fieldset>
                        <legend>분석 시나리오</legend>
                         <div class="form-group">
                            <label for="break-even-base">기준 나이 (더 일찍 시작):</label>
                            <select id="break-even-base"></select>
                         </div>
                         <div class="form-group">
                            <label for="break-even-comparison">비교 나이 (더 늦게 시작):</label>
                            <select id="break-even-comparison"></select>
                         </div>
                         <button id="run-break-even-btn" type="button">손익분기점 분석 실행</button>
                    </fieldset>
                </div>
            </div>

            <div class="output-section">
                <h2>2. 분석 결과</h2>
                <div id="loading-indicator" class="hidden">
                    <p>계산 중입니다...</p>
                    <div class="spinner"></div>
                </div>
                <div id="results-container" class="hidden">
                    <div id="break-even-result">
                         <p id="break-even-text-result"></p>
                         <div class="chart-container">
                            <h3>손익분기점 시각화</h3>
                            <canvas id="breakEvenChart"></canvas>
                        </div>
                    </div>
                    <div class="detailed-table-section">
                        <div class="table-controls">
                            <button id="toggle-details-btn" type="button" class="hidden">상세 데이터 표 보기</button>
                            <button id="export-csv-btn" type="button" class="hidden">CSV로 내보내기</button>
                        </div>
                        <div id="detailed-table-container" class="hidden"></div>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <div id="income-modal" class="modal hidden">
        <div class="modal-content">
            <span class="close-button">&times;</span>
            <h2>기타 소득 관리</h2>
            <div id="income-list"></div>
            <hr>
            <h3>새 소득 추가</h3>
            <div id="add-income-form" class="form-grid-modal">
                <input type="hidden" id="income-id">
                <div class="form-group">
                    <label for="income-desc">소득 종류</label>
                    <input type="text" id="income-desc" placeholder="예: 회사 연금">
                </div>
                <div class="form-group">
                    <label>금액 (연간, 현재 가치)</label>
                    <input type="number" id="income-amount">
                    <div class="future-value-display" id="future-value-display"></div>
                </div>
                <div class="form-group">
                    <label for="income-start-age">시작 나이</label>
                    <input type="number" id="income-start-age">
                </div>
                <div class="form-group">
                    <label for="income-end-age">종료 나이</label>
                    <input type="number" id="income-end-age">
                </div>
            </div>
            <button id="save-income-btn" type="button">추가/수정</button>
        </div>
    </div>

    <script src="data.js"></script>
    <script src="engine.js"></script>
    <script src="ui.js"></script>

</body>
</html>